{% extends "base_plugin.html" %}

{% set logo_frame = false %}

<!-- set update_interval to a value > 0 (in milliseconds) to enable periodic data updates -->
{% set update_interval = 3000 %}

<!--
	Additional script tag for plugin specific javascript code go into this block
-->
{% block pluginscripts %}
<script>
	function handleUpdatedData(response, dataSet=null) {
		if (dataSet === 'devices_info' || dataSet === null) {
			var objResponse = JSON.parse(response);
			myProto = document.getElementById(dataSet);
			for (var device in objResponse) {
				<!--
				shngInsertText (device+'_source', objResponse[device]['source']);
				shngInsertText (device+'_powerState', objResponse[device]['powerState']);
				-->
			}
		}
	}
</script>
{% endblock pluginscripts %}


{% block headtable %}
<table class="table table-striped table-hover"  style="font-size:12px">
	<tbody>
		<tr>
			<td class="py-1"><strong>client_id</strong></td>
			<td class="py-1">{{ p.client_id }}</td>
			<td class="py-1" width="80px"></td>
			<td class="py-1"><strong>client_secret</strong></td>
			<td class="py-1">{{ p.client_secret }}</td>
			<td class="py-1" width="80px"></td>
		</tr>
		<tr>
			<td class="py-1"><strong>access_token</strong></td>
			<td class="py-1">{{ p.AccesToken }}</td>
			<td></td>
			<td class="py-1"><strong>refresh_token</strong></td>
			<td class="py-1">{{ p.RefreshToken }}</td>
			<td></td>
		</tr>
		<tr>
			<td class="py-1"><strong>valid from</strong></td>
			<td class="py-1">{{ p.ValidFrom }}</td>
			<td></td>
			<td class="py-1"><strong>valid through</strong></td>
			<td class="py-1">{{ p.ValidThrough }}</td>
			<td class="py-1">{{ p.ValidFor }} {{ _('d') }}</td>
		</tr>
        		<tr>
			<td class="py-1"><strong>Country</strong></td>
			<td class="py-1">{{ p.country }}</td>
			<td></td>
			<td class="py-1"><strong>Cycle</strong></td>
			<td class="py-1">{{ p._cycle }} {{ _('s') }}</td>
			<td></td>
		</tr>
	</tbody>
</table>
{% endblock headtable %}


<!--
	Additional buttons for the web interface (if any are needed) - displayed below the headtable-section
-->
{% block buttons %}
{% if 1==2 %}
	<div>
		<button id="btn1" class="btn btn-shng btn-sm" name="scan" onclick="shngPost('', {learn: 'on'})"><i class="fas fa-question"></i>&nbsp;&nbsp;&nbsp;{{ _('nach Devices suchen') }}&nbsp;</button>
	</div>
{% endif %}
{% endblock %}

<!--
	Define the number of tabs for the body of the web interface (1 - 3)
-->
{% set tabcount = 3 %}


<!--
	Set the tab that will be visible on start, if another tab that 1 is wanted (1 - 3)
-->
{% if item_count==0 %}
	{% set start_tab = 1 %}
{% endif %}


<!--
	Content block for the first tab of the Webinterface
-->
{% set tab1title = "<strong>" ~ p.get_shortname() ~ " Items</strong> (" ~ item_count ~ ")" %}
{% block bodytab1 %}
<div class="container-fluid m-2">
	
    <div class="table-responsive" style="margin-left: 2px; margin-right: 2px;" class="row">
		<div class="col-sm-12">

			<form action="" method="post">
			<table class="table table-striped table-hover pluginList">
				<thead>
					<tr class="shng_heading">
						<th class="py-1">{{ _('Item') }}</th>
						<th class="py-1">{{ _('Type') }}</th>
                        <th class="py-1">{{ _('Value') }}</th>
					</tr>
				</thead>
				<tbody>
				{% for item in items %}
                    {% if p.has_iattr(item.conf, 'miele_deviceid') %}
                    <tr>
                        <td class="py-1">{{ item._path }}</td>
                        <td class="py-1">{{ item._type }}</td>
                        <td class="py-1">{{ item._value }}</td>
                    {% endif %}
                    </tr>
                {% endfor %}
				</tbody>
			</table>
			</form>
		</div>
	</div>
    
</div>
{% endblock bodytab1 %}


<!--
	Content block for the second tab of the Webinterface
-->
{% set tab2title = "<strong>" ~ p.get_shortname() ~ " Geräte</strong> " %}
{% block bodytab2 %}
<div class="container-fluid m-2">
	
    <div class="table-responsive" style="margin-left: 2px; margin-right: 2px;" class="row">
		<div class="col-sm-12">

			<form action="" method="post">
			<table class="table table-striped table-hover pluginList">
				<thead>
					<tr class="shng_heading">
						<th class="py-1">{{ _('Device ID') }}</th>
                        <th class="py-1">{{ _('Device Type') }}</th>
                        <th class="py-1">{{ _('Device Name') }}</th>
                        <th class="py-1">{{ _('Model') }}</th>
					</tr>
				</thead>
				<tbody>
				{% for item in items %}
                    {% if p.has_iattr(item.conf, 'miele_deviceid') %}
                    <tr>
                        <td class="py-1">{{ p.get_iattr_value(item.conf, 'miele_deviceid') }}</td>
                        <td class="py-1">Gefrierschrank</td>
                        <td class="py-1">Gefrierschrank Vorraum</td>
                        <td class="py-1">FN 26263 ws</td>
                    </tr>
                    {% endif %}
                {% endfor %}
				</tbody>
			</table>
			</form>
		</div>
	</div>
    
</div>
{% endblock bodytab2 %}


<!--
	Content block for the third tab of the Webinterface
	If wanted, a title for the tab can be defined as:
		{% set tab3title = "<strong>" ~ p.get_shortname() ~ " Geräte</strong>" %}

	It has to be defined before (and outside) the block bodytab3
-->
{% set tab3title = "<strong>Event-Informations</strong> " %}
{% block bodytab3 %}
<div class="container-fluid m-2">
    <div class="table-responsive" style="margin-left: 2px; margin-right: 2px;" class="row">
		<div class="col-sm-12">
			<table class="table table-striped table-hover pluginList">
				<thead>
				<tr class="shng_heading">
					<th class="py-1" style="width:50%; text-align:center"> Device-Event</th>
					<th class="py-1" style="width:50%; text-align:center"> Action-Event</th>
				</tr>
				</thead>
				<tr>
					<td style="width:50%; text-align:center">
					Last Update : 
					</td>
					<td style="width:50%; text-align:center">
					Last Update : 
					</td>
				</tr>
			</table>
		</div>
	</div>
</div>
{% endblock bodytab3 %}


<!--
	Content block for the fourth tab of the Webinterface
	If wanted, a title for the tab can be defined as:
		{% set tab4title = "<strong>" ~ p.get_shortname() ~ " Geräte</strong>" %}

	It has to be defined before (and outside) the block bodytab4
-->
{% block bodytab4 %}
{% endblock bodytab4 %}
